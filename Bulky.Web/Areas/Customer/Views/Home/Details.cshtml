@model Cart
@{
    ViewData["Title"] = $"{Model.Product.Title} - Bulky";
}

<!-- Breadcrumb Navigation -->
<nav aria-label="breadcrumb" class="breadcrumb-nav py-3">
    <div class="container">
        <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item">
                <a asp-action="Index" class="text-decoration-none">
                    <i class="bi bi-house"></i> Home
                </a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">@Model.Product.Title</li>
        </ol>
    </div>
</nav>

<!-- Product Details Section -->
<section class="product-details-section py-5">
    <div class="container">
        <div class="row">
            <!-- Product Image -->
            <div class="col-lg-5 mb-4">
                <div class="product-main-image-container">
                    <div class="product-image-wrapper">
                        @if(Model.Product.ProductImages != null && Model.Product.ProductImages.Count() > 0  )
                        {
                            <img src="@Model.Product.ProductImages.FirstOrDefault().ImageUrl" alt="@Model.Product.Title" class="product-main-image" />
                        }
                        else
                        {
                            <img src="https://placehold.jp/500x600.png" class="product-main-image" alt="No Image Available">
                        }
                        
                    </div>
                    <div class="product-badges">
                        <span class="badge bg-warning text-dark">@Model.Product.Category.Name</span>
                        <span class="badge bg-success">In Stock</span>
                    </div>
                </div>
            </div>

            <!-- Product Information -->
            <div class="col-lg-7">
                <div class="product-info">
                    <h1 class="product-title">@Model.Product.Title</h1>
                    <p class="product-author">by <strong>@Model.Product.Author</strong></p>
                    
                    <div class="product-meta mb-4">
                        <div class="meta-item">
                            <i class="bi bi-upc-scan"></i>
                            <span>ISBN: @Model.Product.ISBN</span>
                        </div>
                        <div class="meta-item">
                            <i class="bi bi-star-fill text-warning"></i>
                            <span>4.5 (128 reviews)</span>
                        </div>
                    </div>

                    <div class="product-description mb-4">
                        <h5>Description</h5>
                        <p class="text-muted">@Html.Raw(Model.Product.Description)</p>
                    </div>

                    <!-- Pricing Table -->
                    <div class="pricing-section mb-4">
                        <h5 class="mb-3">Bulk Pricing</h5>
                        <div class="pricing-table">
                            <div class="pricing-header">
                                <div class="pricing-col">Quantity</div>
                                <div class="pricing-col">Price</div>
                                <div class="pricing-col">Savings</div>
                            </div>
                            <div class="pricing-row">
                                <div class="pricing-col">1-50</div>
                                <div class="pricing-col price-value">@Model.Product.Price.ToString("c")</div>
                                <div class="pricing-col savings">@(((Model.Product.ListPrice - Model.Product.Price) / Model.Product.ListPrice * 100).ToString("F0"))%</div>
                            </div>
                            <div class="pricing-row">
                                <div class="pricing-col">51-100</div>
                                <div class="pricing-col price-value">@Model.Product.Price50.ToString("c")</div>
                                <div class="pricing-col savings">@(((Model.Product.ListPrice - Model.Product.Price50) / Model.Product.ListPrice * 100).ToString("F0"))%</div>
                            </div>
                            <div class="pricing-row featured">
                                <div class="pricing-col">100+</div>
                                <div class="pricing-col price-value">@Model.Product.Price100.ToString("c")</div>
                                <div class="pricing-col savings">@(((Model.Product.ListPrice - Model.Product.Price100) / Model.Product.ListPrice * 100).ToString("F0"))%</div>
                            </div>
                        </div>
                        <div class="msrp-info mt-2">
                            <small class="text-muted">Normal Price: <span class="text-decoration-line-through">@Model.Product.ListPrice.ToString("c")</span></small>
                        </div>
                    </div>

                    <!-- Purchase Section -->
                    <div class="purchase-section">
                        <form method="post">
                            <input hidden asp-for="ProductId" />
                            <div class="row align-items-end">
                                <div class="col-md-4 mb-3">
                                    <label for="quantity" class="form-label">Quantity</label>
                                    <div class="input-group">
                                        <div class="quantity-input-group">
                                            <div class="quantity-input-group">
                                                <button type="button" class="quantity-btn quantity-decrease">
                                                    <i class="bi bi-dash"></i>
                                                </button>
                                                <input asp-for="Count" id="quantity" type="number" class="quantity-input" value="@Model.Count" min="1" max="999">
                                                <button type="button" class="quantity-btn quantity-increase">
                                                    <i class="bi bi-plus"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-8 mb-3">
                                    <div class="total-price">
                                        <span class="total-label">Total Price:</span>
                                        <span class="total-amount" id="totalPrice">@Model.TotalPrice.ToString("c")</span>
                                    </div>
                                </div>
                            </div>

                            <div class="action-buttons">
                                <button  type="submit" class="btn btn-primary btn-lg add-to-cart-btn">
                                    <i class="bi bi-cart-plus"></i> Add to Cart
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Additional Features -->
                    <div class="product-features mt-4">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="feature-item">
                                    <i class="bi bi-truck text-success"></i>
                                    <span>Free shipping on orders over $50</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-item">
                                    <i class="bi bi-shield-check text-success"></i>
                                    <span>Secure payment processing</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-item">
                                    <i class="bi bi-arrow-clockwise text-success"></i>
                                    <span>30-day return policy</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-item">
                                    <i class="bi bi-headset text-success"></i>
                                    <span>24/7 customer support</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



@section Scripts {
    <script>
        $(document).ready(function () {
            const $quantityInput = $('#quantity');
            const $totalPrice = $('#totalPrice');

            function getUnitPrice(quantity) {
                if (quantity > 100) return @Model.Product.Price;
                if (quantity > 50) return @Model.Product.Price50;
                return @Model.Product.Price;
            }

            function updateTotalPrice() {
                let quantity = parseInt($quantityInput.val());
                if (isNaN(quantity) || quantity < 1) {
                    quantity = 1;
                    $quantityInput.val(quantity);
                }
                const unitPrice = getUnitPrice(quantity);
                const total = quantity * unitPrice;
                $totalPrice.text('$' + total.toFixed(2));
            }

            $('.quantity-increase').on('click', function (e) {
                let current = parseInt($quantityInput.val()) || 1;
                $quantityInput.val(current + 1);
                updateTotalPrice();
            });

            $('.quantity-decrease').on('click', function (e) {
                let current = parseInt($quantityInput.val()) || 1;
                if (current > 1) {
                    $quantityInput.val(current - 1);
                    updateTotalPrice();
                }
            });

            $quantityInput.on('input', updateTotalPrice);

            updateTotalPrice();
        });
    </script>
}


